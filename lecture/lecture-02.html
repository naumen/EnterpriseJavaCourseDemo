<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>DevOps</title>

        <meta name="description" content="Talk about java dev ops">
        <meta name="author" content="Denis V. Kirpichenkov">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/white.css" id="theme">

        <link rel="stylesheet" href="css/hljs/vs.css" id="highlight-theme">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->

        <style>
.reveal .slide-number {
    font-size:22pt;
    color:black;
}

.reveal pre {
    background: none;
    border: none;
    box-shadow: none;    
}

.reveal pre code{
    color: black;
    background: none;
    box-shadow: none;
    max-height: none;
}

.reveal section img {
    border: none;
    box-shadow: none;
}

.reveal pre code {
    overflow: hidden;
}

.reveal .footer {
    font-size:22pt;
    color:black;

    position: absolute; 
    left: 35%;  
    bottom: 0.5em;
}
        </style>
    </head>

    <body>

        <div class="reveal">

        <div class="footer">
        NAUMEN, Кирпиченков Денис Викторович
        </div>

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">
                <section>
                    <h1>Промышленное приложение</h1>
                    <p>
                        <h3>это не только приложение</h3>
                        <br/>
                        <small>
                        <a href="https://github.com/d0k1">Кирпиченков Денис</a> / <a href="mailto:dkirpichenkov@naumen.ru">dkirpichenkov@naumen.ru</a>
                        <br/>
                        <br/>
                        <a href="https://d0k1.github.io/JavaDevOpsTalk/">d0k1.github.io/JavaDevOpsTalk/</a>
                        </small>
                    </p>
                </section>

                <section>
                        <h1>План</h1>
                        <p>
                            <ul>
                                <li>Git</li>
                                <li>Maven</li>
                                <li>Jenkins</li>
                                <li>Github</li>
                                <li>Openshift</li>
                                <li>Все сразу</li>
                            </ul>
                        </p>
                    </section>

                    <section>
                        <h1>Version Control Systems</h1>
                        <h2>git</h2>                        
                    </section>

                    <section>
                        <h1>Version Control Systems</h1>
                        <ul>
                            <li>Репозитарий</li>
                            <li>Коммит</li>
                            <li>Версия/Состояние/Ревизия</li>
                        </ul>
                    </section>

                <section>
                    <h1>Version Control Systems</h1>
                    <p>
                        <ul>
                            <li>Чтобы видеть историю изменений</li>
                            <li>Чтобы переключаться между состояниями кода</li>
                            <li>Удобно вести совместную работу</li>
                            <li>Увидеть автора и дату создания версии</li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Два типа VCS</h1>
                    <p>
                        <ul>
                            <li>Централизованные VCS: cvs / svn / etc</li>
                            <li>Распределенные VSC: Mercurial, BitKeeper, Bazaar, Git</li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Централизованные VCS</h1>
                    <p> Достоинства
                        <ul>
                            <li>Всё хранится на сервере</li>
                            <li>Централизованная блокировка изменений</li>
                        </ul>
                    </p>
                    <p> Недостатки
                            <ul>
                                <li>Невозможно работать без доступа к серверу</li>
                                <li>Один сервер - уникальная точка отказа</li>
                            </ul>
                        </p>
                </section>

                <section>
                    <h1>Распределенные VCS</h1>
                    <p> Достоинства
                        <ul>
                            <li>Практически невозможно потерять репозиторий</li>
                            <li>Работа с версиями не зависит от доступности сервера</li>
                        </ul>
                    </p>
                    <p> Недостатки
                            <ul>
                                <li>Невозможны централизованные блокировки файлов</li>
                            </ul>
                        </p>
                </section>

                <section>
                        <h1>Git: появление</h1>
                        <p>
                            <ul>
                                <li>Распределенная комманда разработки</li>
                                <li>Необходимость версионировать и просматривать каждое изменение</li>
                                <li>BitKeeper</li>
                            </ul>
                        </p>
                        <a href="https://git-scm.com/book/en/v2/Getting-Started-A-Short-History-of-Git">git-scm.com/book/en/v2/Getting-Started-A-Short-History-of-Git</a>
                </section>

                <section>
                    <h1>Ветки / branch</h1>
                    <img src="img/git_branches.png" style="width:500px"/>
                </section> 
                
                <section>
                        <h1>Ветки / branch</h1>
                        <img src="img/git_branches_2.png" style="width:500px"/>
                </section> 
                
                <section>
                    <h1>Git: cheat sheet</h1>
                    <p>
                        <ul>
                            <li>git clone ${url}</li>
                            <li>git checkout ${branchName}</li>
                            <li>Do work</li>
                            <li>git add .</li>
                            <li>git commit -m ${MessageAboutCommit}</li>
                            <li>git push origin ${branchName}</li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Система сборки</h1>
                    <h2>Maven</h2>
                </section>

                <section>
                        <h1>Нет системы сборки</h1>
                        <pre style="width:auto;"><code data-trim class="java">
class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello World!");
    }
}
                        </code></pre>
                        <pre style="width:auto;"><code data-trim class="bash">
$ javac HelloWorld.java
$ java HelloWorld
                        </code></pre>
                </section>
                <section>
                        <h1>Больше кода</h1>
                        <pre style="width:auto;"><code data-trim class="java">
class HelloWorld {
    public static void main(String[] args) {
        Printer.print("Hello World!");
    }
}

class Printer {
    public static void print(String text) {
        System.out.println(text);
    }
}
                        </code></pre>
                        <pre style="width:auto;"><code data-trim class="bash">
$ javac Printer.java HelloWorld.java
$ java HelloWorld
                        </code></pre>
                </section>

                <section>
                    <h1>Система сборки. Требования</h1>
                    <p>
                        <ul>
                            <li>Сборка вне IDE</li>
                            <li>Запуск тестов</li>
                            <li>Особая структура файлов</li>
                            <li>Зависимости</li>
                            <li>Upload</li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Системы сборки для Java</h1>
                    <p>
                        <ul>
                            <li>Ant</li>
                            <li>Maven</li>
                            <li>Gradle</li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Maven</h1>
                    <p> Одна из самых популярных систем сборки
                        <br/>
                        <a href="https://maven.apache.org">https://maven.apache.org</a>
                        <ul>
                            <li>описание проекта в файле pom.xml</li>
                            <li>сделан для сборки в Java</li>
                            <li>всегда один выход: Jar, war, ear...</li>
                            <li>много plugin-ов</li>
                            <li>у цикла жизни много фаз</li>
                        </ul>
                    </p>
                </section>
                
                <section>
                    <h1>Работа Maven</h1>
                    <img src="img/mavan_cycle.png" style="width:auto; height:500px"/>
                </section>
                
                <section>
                    <h1>Структура проекта</h1>
                    <img src="img/maven_projecT_structure.png" style="width:auto; height:500px"/>
                </section>

                <section>
                    <h1>Maven артефакт</h1>
                    <ul>
                        <li>groupId <cite>ru.naumen</cite></li>
                        <li>artifactId <cite>cti</cite></li>
                        <li>version <cite>4.8.0</cite></li>
                        <li>scope <cite>compile</cite></li>
                        <li>excludes</li>
                    </ul>
                </section>
                <section>
                        <h1>Структура pom.xml</h1>
                        <pre style="width:auto;"><code data-trim class="xml">
<project>
    <groupId>ru.urfu.matmex</groupId>
    <artifactId>simple</artifactId>
    <packaging>jar</packaging>
    <version>1.0</version>
    <name>Simple Project</name>
...
</project>
                        </code></pre>
                </section>

                <section>
                        <h1>Зависимости</h1>
                        <pre style="width:auto;"><code data-trim class="xml">
<project>
    <properties> <beanutils.version>1.8.3</beanutils.version> </properties>
    <dependencies>
        <dependency>
            <groupId>junit</groupId>
            <artifactId>junit</artifactId>
            <version>4.12</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>commons-beanutils</groupId>
            <artifactId>beanutils</artifactId>
            <version>${beanutils.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies> 
    ...
</project>
                        </code></pre>
                </section>
                <section>
                        <h1>Объявление переменных</h1>
                        <pre style="width:auto;"><code data-trim class="xml">
<project>
    <properties> <beanutils.version>1.8.3</beanutils.version> </properties>
    ...
</project>
                        </code></pre>
                </section>
                <section>
                        <h1>Зависимость</h1>
                        <pre style="width:auto;"><code data-trim class="xml">
<project>
    <dependencies>
            <dependency>
                <groupId>junit</groupId>
                <artifactId>junit</artifactId>
                <version>4.12</version>
                <scope>test</scope>
            </dependency>
    </dependencies>
</project>
                        </code></pre>
                </section>
                <section>
                    <h1>Транзитивные зависимости</h1>
                    <pre style="width:auto;"><code data-trim class="xml">
<project>
<dependencies>
        ...
        <dependency>
            <groupId>commons-beanutils</groupId>
            <artifactId>beanutils</artifactId>
            <version>${beanutils.version}</version>
            <exclusions>
                <exclusion>
                    <groupId>commons-logging</groupId>
                    <artifactId>commons-logging</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
    </dependencies> 
... 
</project>
                    </code></pre>
                </section>
                
                <section>
                    <h1>Scope зависимостей</h1>
                    <ul>
                        <li>compile</li>
                        <li>test</li>
                        <li>provided</li>
                        <li>runtime</li>
                        <li>system</li>
                    </ul>
                </section>

                <section>
                    <h1>Система непрерывной интеграции</h1>
                    <h2>Jenkins</h2>
                </section>

                <section>
                    <h1>Система непрерывной интеграции</h1>
                    <ul>
                        <li>Рутина</li>
                        <li>Плохой код в репозитарии</li>
                        <li>Проблемы окружения</li>
                        <li>История сборок</li>
                        <li>Много-много тестов</li>
                    </ul>
                </section>
                <section>
                    <h1>Рутина</h1>
                    <pre style="width:auto;"><code data-trim class="bash">
mvn clean install
cp target/artifact.war ../tomcat/webapps
../tomcat/bin/startup.sh
mvn test
                    </code></pre>
                </section>
                <section>
                    <h1>Плохой код</h1>
                    <table>
                        <tr>
                            <td>"Плохой" разработчик</td>
                            <td>"Хороший" разработчик</td>
                        </tr>
                        <tr>
                            <td>
                                <pre style="width:auto;"><code data-trim class="bash">
# завтра в отпуск
git checkout master
# Надо срочно доделать задачу
git commit -am 'Killer feature'
git push origin master
# Наконец то отпуск
                                </code></pre>
                            </td>
                            <td>
                                <pre style="width:auto;"><code data-trim class="bash">
git checkout master
git pull
mvn clean install
...
BUILD FAILED
                                </code></pre>
                            </td>
                        </tr>
                    </table>
                </section>
                <section>
                    <h1>Проблемы окружения</h1>
                    <table>
                        <tr>
                            <td>Windows 95 OSR2</td>
                            <td>MacPro late 2017</td>
                        </tr>
                        <tr>
                            <td><img src="img/your_pc.png"/></td>
                            <td><img src="img/not_your_pc.png" /></td>
                        </tr>
                    </table>
                </section>
                <section>
                    <h1>История сборок</h1>
                    <table>
                        <tr>
                            <td><img src="img/build_history.png"/></td>
                            <td><img src="img/build_info.png" /></td>
                        </tr>
                    </table>
                </section>
                <section>
                    <h1>Много тестов</h1>
                    <div>8.5kilo тестов, 24 дочерних узла</div>
                    <img src="img/many_tests.png"/>
                </section>
                <section>
                    <h1>Цикл разработки</h1>
                    <img src="img/develop_cycle.png" />
                </section>
                <section>
                    <h1>CI Jenkins</h1>
                    <ul>
                        <li>Быстро находит ошибки</li>
                        <li>Тестируем весь код</li>
                        <li>Наличие стабильной версии кода</li>
                        <li>Повышение качества</li>
                    </ul>
                </section>
                <section>
                    <h1>Jenkins. Общий вид</h1>
                    <img src="img/ci_diagram.png"/>
                </section>
                <section>
                    <h1>Наш цикл интеграции</h1>
                    <ul>
                        <li>Триггер (расписание, git) </li>
                        <li>Сборка</li>
                        <li>Статический анализ</li>
                        <li>Unit тестирование</li>
                        <li>Присвоение версии</li>
                        <li>Функциональные тесты</li>
                        <li>Сохранение</li>
                        <li>Отчет</li>
                    </ul>
                </section>
                
                <section>
                    <h1>Github</h1>
                    <p>
                        Весь код интернета
                    </p>
                    <p>
                        Аналоги
                        <ul>
                            <li>Google code</li>
                            <li>Microsoft Codeplex</li>
                            <li><b>BitBucket</b></li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Github flow</h1>
                    <ul>
                        <li>Fork репозитария</li>
                        <li>Создание ветки</li>
                        <li>Коммит</li>
                        <li>Pull request</li>
                        <li>Merge</li>
                    </ul>
                </section>

                <section>
                    <h1>GitHub. Инструменты</h1>
                    <ul>
                        <li>CodeShip</li>
                        <li>Codacy / Codeclimate</li>
                        <li>JitPack</li>
                    </ul>
                </section>

                <section>
                    <h1>Развертывание</h1>
                    <ul>
                        <li>Запуск на железе</li>
                        <li>Запуск на виртуальной машине</li>
                        <li>Запуск в контейнере</li>
                    </ul>
                </section>

                <section>
                    <h1>Запуск на железе</h1>
                    <p>
                        <ul>
                            <li>Простота</li>
                            <li>Доступность</li>
                            <li></li>
                            <li>Что если сгорит?</li>
                            <li>Что если не хватит мощности?</li>
                        </ul>
                    </p>
                </section>

                <section>
                    <h1>Запуск в VM</h1>
                    <p>
                        Полная эмуляция железа
                        <ul>
                            <li>Надежность</li>
                            <li>Переносимость</li>
                            <li></li>
                            <li>Накладные расходы</li>
                        </ul>
                    </p>
                </section>
                
                <section>
                    <h1>Запуск в docker</h1>
                    <p>
                        Псевдо эмуляция железа - изоляция приложений
                        <ul>
                            <li>Надежность</li>
                            <li>Переносимость</li>
                            <li></li>
                            <li>Меньшие накладные расходы</li>
                        </ul>
                    </p>
                </section>
        <section>
            <h1>Лучшего варианта нет</h1>
        </section>
                <section>
                    <h1>Cloud провайдеры</h1>
                    <ul>
                        <li>MS Azure / AWS</li>
                        <li>Heroku</li>
                        <li>Openshift</li>
                    </ul>
                </section>
                <section>
                    <h1>Openshift</h1>
                    <ul>
                        <li>Docker</li>
                        <li>Kubernetes</li>
                        <li>UI</li>
                    </ul>
                    <p><a href="https://148.251.87.70.nip.io:8443">https://148.251.87.70.nip.io:8443</a> </p>
                </section>
                
                <section>
                        <h1>InfluxDb</h1>
                        <p><a href="https://www.influxdata.com/time-series-platform/influxdb/">https://www.influxdata.com/time-series-platform/influxdb/</a></p>
                        <p>
                            Time-series (NoSql) база данных
                        </p>
                        <p>Каждая БД содержит набор замеров (последовательностей / series) данных</p>
                        <p>
                            Каждая "строка" набора замеров - Время, Значение, Тэги
                        </p>
                </section>

                <section>
                        <h1>InfluxDb</h1>
                        <ul>
                            <li>Оптимально хранит Time Series данные</li>
                            <li>Позволяет сразу по ним считать статистику</li>
                            <li>Позволяет "архивировать" старые данные</li>
                            <li>Визуализация метрик</li>
                            <li>SQL like язык запросов</li>
                        </ul>
                </section>
                
                <section>
                        <h1>InfluxDb</h1>
                        <p>
                            Простой запрос
                            <br/>
                            127.0.0.1:8086/query?q=SHOW+DATABASES
                        </p>
                </section>

                <section>
                        <h1>Openshift. Проект</h1>
                        <p>4 независимых контейнера</p>
                        <ul>
                            <li>WildFly</li>
                            <li>NDAP</li>
                            <li>InfluxDb</li>
                            <li>PostgreSQL</li>
                        </ul>
                </section>

                <section>
                        <h1>Openshift</h1>
                        <ul>
                            <li>новый проект</li>
                            <li>Точки доступа(Url)</li>
                            <li>Логины пароли</li>
                            <li>Переменные окружения</li>
                            <li>Обновление приложения</li>
                            <li>Логи</li>
                        </ul>
                </section>

                <section>
                        <h1>Openshift. Новый проект</h1>
                        <img src="img/openshift01.png"/>
                </section>
        
                <section>
                        <h1>Openshift. Новый проект</h1>
                        <img src="img/openshift02.png"/>
                </section>

                <section>
                        <h1>Openshift. Новый проект</h1>
                        <img src="img/openshift18.png"/>
                </section>

                <section>
                        <h1>Openshift. Новый проект</h1>
                        <img src="img/openshift19.png"/>
                </section>

                <section>
                        <h1>Openshift. Новый проект</h1>
                        <img src="img/openshift05.png"/>
                </section>

                <section>
                        <h1>Openshift. 4 контейнера</h1>
                        <img src="img/openshift06.png"/>
                </section>

                <section>
                        <h1>Openshift. Urls</h1>
                        <img src="img/openshift07.png"/>
                </section>

                <section>
                        <h1>Openshift. Urls</h1>
                        <img src="img/openshift07-1.png"/>
                </section>

                <section>
                        <h1>Openshift. Пароли</h1>
                        <img src="img/openshift08.png"/>
                </section>

                <section>
                        <h1>Openshift. Пароли</h1>
                        <img src="img/openshift09.png"/>
                </section>

                <section>
                        <h1>Openshift. Пароли</h1>
                        <img src="img/openshift10.png"/>
                </section>

                <section>
                        <h1>Openshift. Окружение</h1>
                        <img src="img/openshift12.png"/>
                </section>

                <section>
                        <h1>Openshift. Окружение</h1>
                        <img src="img/openshift13.png"/>
                </section>

                <section>
                        <h1>Openshift. Новая сборка</h1>
                        <img src="img/openshift14.png"/>
                </section>

                <section>
                        <h1>Openshift. Логи</h1>
                        <img src="img/openshift15.png"/>
                </section>

                <section>
                        <h1>Openshift. Логи</h1>
                        <img src="img/openshift16.png"/>
                </section>

                <section>
                        <h1>Openshift. Логи</h1>
                        <img src="img/openshift17.png" style="height:350px; width:1100px"/>
                </section>

                <section>
                    <h1>Первое задание</h1>
                    <ul>
                        <li>Форк https://github.com/naumen/liquid-log</li>
                        <li>Создание ветки</li>
                        <li>Коммит</li>
                        <li>Pull Request</li>
                        <li>Упоминание @ykalemi, @d0k1</li>
                        <li>Комментарии</li>
                        <li>Merge</li>
                    </ul>
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: false,
                progress: true,
                history: true,
                center: true,
                slideNumber: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
            });

        </script>

    </body>
</html>
